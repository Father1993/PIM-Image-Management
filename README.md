# üñºÔ∏è PIM Image Management Suite

–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Ç–æ–≤–∞—Ä–æ–≤ –≤ PIM —Å–∏—Å—Ç–µ–º–µ.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á —Ä–∞–±–æ—Ç—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏:

### üîç –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

-   **`check_proportion.py`** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ 750√ó1000px
-   **`check_small_images_ASYNC.py`** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ < 500px
-   **`check_big_images_ASYNC.py`** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ > 1500px
-   **`check_all_template_size.py`** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ —à–∞–±–ª–æ–Ω—É
-   **`images_ASYNC.py`** - –ø–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### ‚öôÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

-   **`optimized.py`** - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ imgproxy
-   **`update_perfect_images.py`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è `is_perfect` –≤ Supabase
-   **`add_pim_url.py`** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ PIM –≤ Supabase

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:

```env
# PIM API
PIM_API_URL=your_pim_api_url
PIM_LOGIN=your_login
PIM_PASSWORD=your_password
PIM_IMAGE_URL=your_image_url

# Supabase
SUPABASE_URL=your_supabase_url
SUPABASE_KEY=your_supabase_key

# Imgproxy (–¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
IMGPROXY_URL=your_imgproxy_url
```

### 3. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É –≤ Supabase

–í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ `create_product_images_table.sql`

## üîç –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –ü–æ–∏—Å–∫ —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (750√ó1000px)

```bash
python check_proportion.py
```

-   –ù–∞—Ö–æ–¥–∏—Ç —Ç–æ–≤–∞—Ä—ã —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ —Ä–∞–∑–º–µ—Ä–æ–º 750√ó1000px
-   –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Excel —Ñ–∞–π–ª
-   –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª `products_reference_750x1000.xlsx`

### –ü–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```bash
# –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–Ω—å—à–µ 500px
python check_small_images_ASYNC.py

# –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–æ–ª—å—à–µ 1500px
python check_big_images_ASYNC.py

# –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —à–∞–±–ª–æ–Ω—É (500-1500px)
python check_all_template_size.py

# –¢–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
python images_ASYNC.py
```

## ‚öôÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```bash
# –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º - –æ–±—Ä–∞–±–æ—Ç–∞–µ—Ç 1-5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
python optimized.py preview

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
python optimized.py scan

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ imgproxy
python optimized.py optimize

# –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ –≤ PIM
python optimized.py upload

# –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª (scan ‚Üí optimize ‚Üí upload)
python optimized.py full

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã imgproxy
python optimized.py test
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è is_perfect –¥–ª—è —ç—Ç–∞–ª–æ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
python update_perfect_images.py

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫ PIM –≤ Supabase
python add_pim_url.py
```

## üìä –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

–í—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

-   **–®–∏—Ä–∏–Ω–∞**: 750px
-   **–í—ã—Å–æ—Ç–∞**: 1000px (—Å –±–µ–ª—ã–º —Ñ–æ–Ω–æ–º)
-   **–§–æ—Ä–º–∞—Ç**: JPEG
-   **–ö–∞—á–µ—Å—Ç–≤–æ**: 85%

## üìã –¢–∞–±–ª–∏—Ü–∞ product_images

–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

| –ü–æ–ª–µ           | –û–ø–∏—Å–∞–Ω–∏–µ                         |
| -------------- | -------------------------------- |
| `id`           | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∑–∞–ø–∏—Å–∏             |
| `product_id`   | ID —Ç–æ–≤–∞—Ä–∞ –≤ PIM                  |
| `image_name`   | –ò–º—è —Ñ–∞–π–ª–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è            |
| `image_type`   | –¢–∏–ø –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–û—Å–Ω–æ–≤–Ω–æ–µ/–î–æ–ø.)  |
| `is_optimized` | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ imgproxy    |
| `is_uploaded`  | –ó–∞–≥—Ä—É–∂–µ–Ω–æ –æ–±—Ä–∞—Ç–Ω–æ –≤ PIM          |
| `is_perfect`   | –≠—Ç–∞–ª–æ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ 750√ó1000px |

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

```sql
-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT
    COUNT(*) as total,
    SUM(CASE WHEN is_optimized THEN 1 ELSE 0 END) as optimized,
    SUM(CASE WHEN is_uploaded THEN 1 ELSE 0 END) as uploaded,
    SUM(CASE WHEN is_perfect THEN 1 ELSE 0 END) as perfect
FROM product_images;

-- –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
SELECT product_id, image_name, image_type
FROM product_images
WHERE NOT is_optimized
LIMIT 10;

-- –≠—Ç–∞–ª–æ–Ω–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
SELECT product_id, image_name, image_type
FROM product_images
WHERE is_perfect = true
LIMIT 10;
```

## üìÅ –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã

–°–∫—Ä–∏–ø—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç Excel —Ñ–∞–π–ª—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞:

-   `products_reference_750x1000_ASYNC_[–¥–∞—Ç–∞].xlsx` - —Ç–æ–≤–∞—Ä—ã —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
-   `products_small_images_ASYNC_[–¥–∞—Ç–∞].xlsx` - —Ç–æ–≤–∞—Ä—ã —Å –º–∞–ª–µ–Ω—å–∫–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
-   `products_big_images_ASYNC_[–¥–∞—Ç–∞].xlsx` - —Ç–æ–≤–∞—Ä—ã —Å –±–æ–ª—å—à–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
-   `products_no_template_size_ASYNC_[–¥–∞—Ç–∞].xlsx` - —Ç–æ–≤–∞—Ä—ã —Å –Ω–µ–ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
-   `products_without_images_ASYNC_[–¥–∞—Ç–∞].xlsx` - —Ç–æ–≤–∞—Ä—ã –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

## üõ†Ô∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

-   **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç asyncio –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–∞–±–æ—Ç—ã
-   **–ü–∞–∫–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** - –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–∞–∫–µ—Ç–∞–º–∏ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∏ API
-   **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫—ç—à–∏—Ä—É—é—Ç—Å—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
-   **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —É—Å—Ç–æ–π—á–∏–≤—ã –∫ —Å–µ—Ç–µ–≤—ã–º –æ—à–∏–±–∫–∞–º –∏ —Ç–∞–π–º–∞—É—Ç–∞–º
-   **–ü—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –≤–µ–¥—É—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª `image_optimizer.log` —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ:

-   –í—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π
-   –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
-   –û—à–∏–±–∫–∞—Ö –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è—Ö
-   –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
