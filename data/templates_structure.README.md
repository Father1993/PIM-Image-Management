# Структура файла templates_structure.json

## Описание

Файл содержит полную структуру шаблонов, групп характеристик, характеристик и их значений из COMPO PIM, экспортированную через API.

## Формат данных

```json
{
  "generated_at": "2025-12-10T06:16:36.032104Z",  // ISO 8601 UTC время генерации
  "template_count": 1466,                          // Общее количество шаблонов
  "templates": [                                   // Массив шаблонов
    {
      "id": 4,                                     // ID шаблона
      "header": "Пилы дисковые ручные",            // Название шаблона
      "templateGroupId": 12,                       // ID группы шаблонов
      "templateGroupTree": [],                     // Иерархия групп (путь)
      "cases": {                                    // Падежные формы (может быть null)
        "nominative": null,
        "genitive": null,
        ...
      },
      "syncUid": "8a4ad865-...",                   // UUID для синхронизации
      "featureCount": 20,                          // Количество характеристик
      "keyFeatureCount": 0,                         // Количество ключевых характеристик
      "productCount": 42,                           // Количество товаров с этим шаблоном
      "enabled": true,                              // Включен ли шаблон
      "deleted": false,                             // Удален ли шаблон
      "groups": [                                   // Группы характеристик
        {
          "id": 2174,                               // ID группы в шаблоне
          "header": "Бренд",                         // Название группы
          "groupId": 8,                             // ID базовой группы
          "templateId": 4,                          // ID шаблона
          "sort": 1,                                // Порядок сортировки
          "features": [                             // Характеристики в группе
            {
              "id": 24591,                          // ID характеристики в шаблоне
              "featureId": 4675,                    // ID базовой характеристики
              "header": "Бренд",                     // Название характеристики
              "type": {                             // Тип данных
                "id": 8,
                "code": "string",                    // Код типа: string, range, select, boolean
                "name": "Строка"                    // Название типа
              },
              "required": false,                    // Обязательная ли характеристика
              "multiple": false,                     // Множественное ли значение
              "isFilter": false,                     // Используется ли в фильтрах
              "keyFeature": false,                   // Ключевая ли характеристика
              "units": [],                          // Единицы измерения (для числовых)
              "validatorId": null,                  // ID валидатора (если есть)
              "sort": 1,                            // Порядок сортировки
              "featureGroupId": 8,                   // ID группы характеристик
              "values": [                           // Предустановленные значения (для select)
                {
                  "id": 824,
                  "value": "Текст значения",
                  "code": null,                     // Код значения (если есть)
                  "color": null,                    // Цвет (для цветовых характеристик)
                  "hash": "1839e759...",            // Хеш значения
                  "enabled": true,                   // Включено ли значение
                  "deleted": false                   // Удалено ли значение
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
```

## Типы характеристик

- **string** (`code: "string"`) - Текстовая строка
- **range** (`code: "range"`) - Числовое значение (может иметь единицы измерения)
- **select** (`code: "select"`) - Выбор из списка (имеет массив `values`)
- **boolean** (`code: "boolean"`) - Логическое значение (да/нет)

## Важные поля

### Шаблон (template)
- `id` - уникальный идентификатор шаблона
- `header` - название шаблона
- `syncUid` - UUID для синхронизации с внешними системами
- `enabled` / `deleted` - статус шаблона

### Группа характеристик (group)
- `id` - ID группы в контексте шаблона
- `groupId` - ID базовой группы характеристик
- `sort` - порядок отображения группы

### Характеристика (feature)
- `id` - ID характеристики в контексте шаблона
- `featureId` - ID базовой характеристики в системе
- `type.code` - определяет тип данных и формат значений
- `values` - массив предустановленных значений (заполнен только для типа `select`)
- `units` - единицы измерения (для числовых характеристик)

### Значение характеристики (value)
- Присутствует только в массиве `values` для характеристик типа `select`
- `value` - текстовое представление значения
- `hash` - уникальный хеш для идентификации значения

## Использование

### Поиск шаблона по ID
```python
import json
data = json.load(open('templates_structure.json', encoding='utf-8'))
template = next((t for t in data['templates'] if t['id'] == 4), None)
```

### Поиск характеристики по featureId
```python
for template in data['templates']:
    for group in template['groups']:
        for feature in group['features']:
            if feature['featureId'] == 4675:
                print(f"Найдено в шаблоне {template['id']}: {feature['header']}")
```

### Получение всех значений характеристики
```python
feature = ...  # характеристика
if feature['type']['code'] == 'select':
    values = [v['value'] for v in feature['values'] if v.get('enabled')]
```

## Примечания

1. Файл отсортирован по `id` шаблонов
2. Пустые массивы `values` означают, что характеристика не имеет предустановленных значений
3. Поле `units` заполнено только для числовых характеристик (`range`)
4. Поле `cases` содержит падежные формы названия шаблона (может быть полностью null)
5. `syncUid` используется для синхронизации с внешними системами

